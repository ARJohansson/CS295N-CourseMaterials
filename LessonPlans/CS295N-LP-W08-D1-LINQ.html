<!DOCTYPE html><html>  <head>    <meta http-equiv="content-type" content="text/html; charset=UTF-8">    <title>Week 8, Day 1, LINQ</title>    <style type="text/css">        body {            font-family: "Arial", "Helvetica", "sans-serif";        }                #week08 {            background-color: #f8ff2e;        }                code {            font-size: larger;            background-color: lightgoldenrodyellow;        }    </style>  </head>  <body>    <header> <b>CS295N Web Development 1: ASP.NET&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;        &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; November 13, 2017<br>      </b>      <div>Brian Bird</div>      <br>      <i><b>Topic: Language Integrated Query<br>        </b></i></header>    <section>      <article> <br>        <b>Topics<br>        </b>        <table style="width: 807px; height: 127px;" border="1">          <tbody>            <tr>              <td>1. Intro to Razor Pages</td>              <td>6. More EF and Publishing to Azure</td>            </tr>            <tr>              <td>2. Code-behind, session state, and page layout files</td>              <td>7. Async Programming and More Azure</td>            </tr>            <tr>              <td>3. Tag Helpers, model binding, and unit testing</td>              <td id="week08">8. LINQ and Validation</td>            </tr>            <tr>              <td>4. More on session state and form input</td>              <td>9. Web API<br>              </td>            </tr>            <tr>              <td>5. Entity Framework and SQL Databases</td>              <td>10. Web API and JavaScript<br>              </td>            </tr>          </tbody>        </table>        <b><br>          <br>          Introduction</b><br>        <ul>          <li>Announcements<br>          </li>          <li>Review due dates:</li>          <ul>            <li>Today</li>            <ul>              <li>Lab 7 Code review</li>            </ul>            <li>Wednesday, 11/15:</li>            <ul>              <li>Lab 7 Production version</li>              <li>Term project proposal</li>            </ul>            <li>Saturday, 11/18</li>            <ul>              <li>Lab 8 Beta version</li>            </ul>          </ul>          <li>How is everyone doing on <a href="https://github.com/LCC-CIT/CS295N-CourseMaterials/blob/master/Labs/Lab07/Lab7A-Rev1-instructions_CS295N.pdf"              target="_blank">lab
              7</a>? </li>          <li>Troubleshoot someone’s lab beta?</li>        </ul>      </article>      <article>        <div><b>Term Project Due Dates</b></div>        <div>          <ul>            <li>Proposal: 11/15, Wednesday of this week</li>            <li>Beta version: 11/30, Thursday of week 10</li>            <li>In-class presentation: 12/4, Monday of finals week</li>            <li>Production version: 12/5<b>, </b>Tuesday of finals week<b><br>              </b></li>          </ul>        </div>        <div><b>Overview</b></div>        <div>          <ul>            <b>              <li><a href="#topic1">LINQ</a></li>              <li><a href="#topic2">RazorPagesMovie LINQ Queries<br>                </a></li>              <li><a href="#topic3">Queries with Lambda Expressions</a></li>              <li><a href="#topic4">RazorPagesMovie Queries with Lambda                  Expressions</a></li>              <br>            </b>          </ul>        </div>      </article>    </section>    <section>      <article id="topic1">        <p> <u><b>LINQ Statements </b></u></p>        <ul>          <li>Language Integrated Query – it’s part of C# (and all the .NET            languages) and can be used to query almost anything: an array, list,            XML file, database, and more.</li>          <li> Use this in place of embedding SQL in your C# code or in place of            stored procedures.</li>          <li> LINQ use functional language concepts (SQL also&nbsp; uses <a href="https://en.wikipedia.org/wiki/Functional_programming">functional
              language</a> some functional language concepts like statelessness            and "all at once", non-sequential, operations)</li>          <li> LINQ Syntax (Query expression syntax, as opposed to fluent            syntax) (inspired by languages like LISP and Haskell) Looks <u>              superficially</u> like SQL – but it’s significantly different.</li>          <ul>            <li> Essential operators: <i>from</i>, <i>select</i>, <i>where</i></li>            <li>Full list of LINK keywords: <a href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/query-keywords">Query
                Keywords</a></li>            <li>Walk through the <a href="https://github.com/ProfBird/CS295-Demos/tree/master/LinqDemo">Planet
                example</a></li>            <ul>              <li> Assume a Planet class.<br>                <br>                <code> public class Planet<br>                  &nbsp;&nbsp;&nbsp; {<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public string Name                  {get; set;}<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int Diameter                  {get; set;}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; //                  km<br>                  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; public int                  DistanceToSun {get; set;}&nbsp;&nbsp;&nbsp; // million km<br>                  &nbsp;&nbsp;&nbsp; }<br>                  <br>                </code></li>              <li> Assume a Planet List in which each&nbsp; of the eight planets                has a: name, size, and distance from the sun.<br>                <br>                <code>List&lt;Planet&gt; planets = new List&lt;Planet&gt;();<br>                  planets.Add(new Planet{Name="Mercury", Diameter=4879,                  DistanceToSun=67});<br>                  // TODO: add the other seven planets<br>                  <br>                </code></li>              <li>This LINQ statement will return all the planets within 200                million km of the sun <code><br>                  <br>                  IEnumerable&lt;String&gt; innerPlanets = <b>from</b> p in                  planets <b>where</b> p.DistanceToSun &lt; 200 <b>select</b>                  p.Name;<br>                  <br>                </code></li>              <ul>                <li> <i>from</i> declares the <i>range variable</i>. The <i>range
                    variable</i> represents the current element in the                  collection that is being queried. Its scope is just this                  query. </li>                <li> <i>select</i> specifies the objects to retrieve.</li>                <li><i>where</i> filters the objects that are retrieved.<br>                </li>              </ul>            </ul>            <ul>              <li>Compare the LINQ statement above to the header of the <i>foreach</i>                loop below. Notice the similar use of the <i>range variables</i>.<br>                <code>foreach (<b>Planet p</b> in planets)<br>                </code><br>              </li>            </ul>            <li>Deferred execution: A LINQ statement returns an IEnumerable or              an IQueryable. They look like collections, but they do not contain              any actual data. They just represent the query and are executed              when enumerated</li>            <ul>              <li>The query above won't be executed until you enumerate&nbsp; <i>innerPlanets</i><br>                <code>foreach (String s in innerPlanets)<br>                  {<br>                  &nbsp;&nbsp; Console.Write(s + ", ");<br>                  }<br>                  <br>                </code></li>              <li>You can get a collection directly from a LINQ query by adding                a scalar operator, like <i>ToList</i>.<br>                <code>List&lt;String&gt; innerPlanets = (from p in planets where                  p.DistanceToSun &lt; 200 select p.Name).ToList();<br>                  <br>                </code></li>            </ul>            <li>Queries return a collection unless a scalar operator is applied              (first, count, etc.)<br>              <code>int planetCount = (from p in planets where p.DistanceToSun                &lt; 200 select p.Name).count();<br>                <br>              </code></li>            <li> Exercise: Modify the Planet example</li>            <ul>              <li> Modify the query to return the name of planets greater than a                certain size.</li>              <ul>                <li> Return name and size</li>              </ul>              <li>Modify the query to search for "Earth".</li>              <ul>                <li>Return the size and distance from the sun</li>                <li>Hint: Use .SingleOrDefault() at the end of the query<br>                </li>              </ul>            </ul>            <ul>            </ul>          </ul>        </ul>        <p></p>        <code></code> </article>      <article id="topic2">        <p><u><b>RazorPagesMovie LINQ Queries </b></u></p>        <p>Look at the queries used in Index.cshtml.cs.</p>        <ul>          <li>What is the one below used for?</li>          <li>What are <i>_contex</i>t and <i>_context.Movie</i>?</li>          <li>What new keyword was used? (one that wasn't introduced above)</li>          <li>Can you tell what that keyword does?</li>        </ul>        <code>IQueryable&lt;string&gt; genreQuery = from m in _context.Movie<br>          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          orderby m.Genre<br>          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          select m.Genre;<br>        </code> <br>        How is <i>genreQuery</i> being used here?<br>        <ul>          <li>When does the query get evaluated</li>          <li>What do you think the Distinct method does?</li>        </ul>        <code>Genres = new SelectList(await          genreQuery.Distinct().ToListAsync());</code> <br>        <code></code><code></code></article>      <article id="topic3">        <p><b><u>Queries in Lambda Expressions </u><br>          </b></p>        <p>About objective 3</p>        Example:<br>        &nbsp; <code>innerPlanets = planets.Where(p =&gt; p.DistanceToSun &lt;          200).Select(p =&gt; p.Name);</code> <br>        <br>        Exercise: Make the same modifications to the Planet example as in the        previous exercise, but use lambda expressions.</article>      <article id="topic4">        <p><b><u>RazorPagesMovie Queries with Lambda Expressions </u><br>          </b></p>        <p>There are two on Index.cshtml.cs. Can you find them?</p>        Example:<br>        &nbsp; <code>movies = movies.Where(s =&gt;          s.Title.Contains(searchString));</code> </article>      <br>      <b>This week's Lab Assignment<br>      </b>      <ul>        <li>Query using a "normal" LINQ expression</li>        <li>Query using a lambda expression</li>        <li>Add validation</li>      </ul>    </section>  </body></html>